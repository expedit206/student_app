import{a as R,b as V,_ as j}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-B9Uxm6xL.js";import{d as B,j as y,s as T,q,c as I,A as G,M as K,g as l,o as t,b as a,i as r,h as p,u as i,e as c,w as f,T as v,t as w,f as D,F as O,r as U,a as X,z as H,R as J}from"./app-hzVHw_t7.js";import{_ as m}from"./TextLink.vue_vue_type_script_setup_true_lang-BN_Qr0I0.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Y={class:"min-h-screen bg-gray-900 text-gray-100 flex overflow-hidden"},Z={class:"flex flex-col h-full"},ee={class:"p-4 flex items-center justify-between bg-gray-900"},ae={key:0,class:"flex items-center gap-3"},se={class:"flex-1 py-4"},te={key:0,class:"space-y-2"},le={key:0,class:"flex-1"},ne={key:0,class:"flex-1"},oe={key:0,class:"flex-1"},re={key:1,class:"bg-red-500 text-white text-xs rounded-full px-2 py-0.5 ml-2 animate-pulse"},ie={key:0,class:"flex-1"},ue={key:0,class:"flex-1"},de={key:1,class:"space-y-2"},fe={key:0,class:"flex-1"},ce={key:0,class:"flex-1"},ve={key:0,class:"flex-1"},pe={key:0,class:"flex-1"},me={key:0,class:"flex-1"},ge={key:2,class:"space-y-2"},xe={key:0,class:"flex-1"},he={key:0,class:"flex-1"},ye={key:0,class:"flex-1"},_e={key:0,class:"flex-1"},ke={key:0,class:"flex-1"},be={key:3,class:"mt-6 px-4"},we={key:0,class:"space-y-3 max-h-64 overflow-y-auto"},Ce={class:"text-sm text-white"},Me={class:"text-xs text-gray-400 mt-1"},Ae=["onClick"],De={key:1,class:"text-sm text-gray-400 italic"},Ne={class:"mt-4 px-4"},Se={key:0,class:"flex-1"},Fe={class:"p-4 mt-auto"},ze={class:"flex items-center justify-between w-full px-4 py-3 bg-gray-800 text-gray-200 rounded-lg hover:bg-gray-700 transition-all duration-300"},Ee={class:"flex items-center gap-2"},Le={key:0,class:"flex-1"},Pe={key:1,class:"bg-red-500 text-white text-xs rounded-full px-2 py-0.5 animate-pulse"},We={key:0,class:"fas fa-chevron-down"},$e=B({__name:"MonLayout",setup(Re){var z;const o=y(!0),n=y(!1),s=y(!1),C=()=>{s.value=window.innerWidth<1024,s.value?n.value=!1:n.value=!0},N=()=>{s.value?n.value=!n.value:o.value=!o.value},M=T(),h=M.props.auth.user,E=h&&h.role==="admin",L=h&&h.role==="formateur",S=h&&h.role==="apprenant",g=y(((z=M.props.dashboardData)==null?void 0:z.notifications)||[]);q(()=>{var d;return(d=M.props.dashboardData)==null?void 0:d.notifications},d=>{g.value=d||[]},{immediate:!0});const F=I(()=>g.value.filter(d=>d.type==="note_update").length),P=d=>{var x;const e=(x=document.querySelector('meta[name="csrf-token"]'))==null?void 0:x.content;if(!e){console.error("CSRF token not found");return}J.post(v("notifications.read",d),{},{headers:{"X-CSRF-TOKEN":e}}).then(k=>{k.data.success&&(g.value=g.value.filter(b=>b.id!==d))}).catch(k=>{var b;console.error("Error:",((b=k.response)==null?void 0:b.data)||k.message)})},u=d=>v().current(d),_=y(null),A=y(!1);window.addEventListener("beforeinstallprompt",d=>{d.preventDefault(),_.value=d,A.value=!0});const W=async()=>{if(_.value){_.value.prompt();const{outcome:d}=await _.value.userChoice;console.log(d==="accepted"?"Application installée":"Installation refusée"),_.value=null,A.value=!1}},$=async()=>{if("serviceWorker"in navigator){const d=await navigator.serviceWorker.getRegistrations();for(const e of d)await e.unregister();await navigator.serviceWorker.register("/service-worker.js"),console.log("Service Worker réinitialisé")}};return G(()=>{$(),C(),window.addEventListener("resize",C)}),K(()=>{window.removeEventListener("resize",C)}),(d,e)=>(t(),l("div",Y,[a("aside",{class:p(["sidebar flex-shrink-0 bg-gradient-to-b from-gray-800 to-gray-900 shadow-xl transition-all duration-300 fixed top-0 left-0 h-full z-20",{"w-64":!s.value&&o.value||s.value&&n.value,"w-16":!s.value&&!o.value,"w-0":s.value&&!n.value}])},[a("div",Z,[a("div",ee,[!s.value&&o.value||s.value&&n.value?(t(),l("div",ae,e[0]||(e[0]=[a("div",{class:"bg-white p-1 rounded-full shadow-md"},[a("img",{src:"/img/logo.png",alt:"Logo CFPCa",class:"h-10 w-10 rounded-full animate-spin-slow"})],-1),a("span",{class:"text-lg font-bold text-white"},"CFPCa",-1)]))):r("",!0),a("button",{onClick:N,class:"text-gray-200 hover:text-white p-2 rounded-full hover:bg-gray-600 transition-all ml-auto"},[a("i",{class:p([s.value?n.value?"fas fa-times":"fas fa-bars":o.value?"fas fa-chevron-left":"fas fa-chevron-right","text-lg"])},null,2)])]),a("nav",se,[i(S)?(t(),l("div",te,[c(m,{href:i(v)("apprenant.dashboard"),class:p(["nav-link",{active:u("apprenant.dashboard")}])},{default:f(()=>[e[1]||(e[1]=a("i",{class:"fas fa-home w-6 text-cyan-400"},null,-1)),(s.value?n.value:o.value)?(t(),l("span",le,"Dashboard")):r("",!0)]),_:1},8,["href","class"]),c(m,{href:i(v)("apprenant.disciplines"),class:p(["nav-link",{active:u("apprenant.disciplines")}])},{default:f(()=>[e[2]||(e[2]=a("i",{class:"fas fa-graduation-cap w-6 text-indigo-500"},null,-1)),(s.value?n.value:o.value)?(t(),l("span",ne,"Mes Disciplines")):r("",!0)]),_:1},8,["href","class"]),c(m,{href:i(v)("apprenant.notes"),class:p(["nav-link",{active:u("apprenant.notes")}])},{default:f(()=>[e[3]||(e[3]=a("i",{class:"fas fa-clipboard-check w-6 text-yellow-400"},null,-1)),(s.value?n.value:o.value)?(t(),l("span",oe,"Mes Notes")):r("",!0),F.value>0&&(s.value?n.value:o.value)?(t(),l("span",re,w(F.value),1)):r("",!0)]),_:1},8,["href","class"]),c(m,{href:i(v)("apprenant.carnet"),class:p(["nav-link",{active:u("apprenant.carnet")}])},{default:f(()=>[e[4]||(e[4]=a("i",{class:"fas fa-address-card w-6 text-green-400"},null,-1)),(s.value?n.value:o.value)?(t(),l("span",ie,"Mon Carnet")):r("",!0)]),_:1},8,["href","class"]),c(m,{href:i(v)("apprenant.progression"),class:p(["nav-link",{active:u("apprenant.progression")}])},{default:f(()=>[e[5]||(e[5]=a("i",{class:"fas fa-arrow-trend-up w-6 text-purple-400"},null,-1)),(s.value?n.value:o.value)?(t(),l("span",ue,"Ma Progression")):r("",!0)]),_:1},8,["href","class"])])):r("",!0),i(L)?(t(),l("div",de,[c(m,{href:i(v)("formateur.dashboard"),class:p(["nav-link",{active:u("formateur.dashboard"),"formateur-active":u("formateur.dashboard")}])},{default:f(()=>[e[6]||(e[6]=a("i",{class:"fas fa-home w-6 text-red-500"},null,-1)),(s.value?n.value:o.value)?(t(),l("span",fe,"Dashboard")):r("",!0)]),_:1},8,["href","class"]),c(m,{href:i(v)("formateur.formations"),class:p(["nav-link",{active:u("formateur.formations"),"formateur-active":u("formateur.formations")}])},{default:f(()=>[e[7]||(e[7]=a("i",{class:"fas fa-chalkboard w-6 text-orange-500"},null,-1)),(s.value?n.value:o.value)?(t(),l("span",ce,"Mes Formations")):r("",!0)]),_:1},8,["href","class"]),c(m,{href:i(v)("formateur.apprenants"),class:p(["nav-link",{active:u("formateur.apprenants"),"formateur-active":u("formateur.apprenants")}])},{default:f(()=>[e[8]||(e[8]=a("i",{class:"fas fa-user-graduate w-6 text-yellow-500"},null,-1)),(s.value?n.value:o.value)?(t(),l("span",ve,"Mes Apprenants")):r("",!0)]),_:1},8,["href","class"]),c(m,{href:i(v)("formateur.notes"),class:p(["nav-link",{active:u("formateur.notes"),"formateur-active":u("formateur.notes")}])},{default:f(()=>[e[9]||(e[9]=a("i",{class:"fas fa-pen w-6 text-pink-500"},null,-1)),(s.value?n.value:o.value)?(t(),l("span",pe,"Gérer les Notes")):r("",!0)]),_:1},8,["href","class"]),c(m,{href:i(v)("formateur.disciplines"),class:p(["nav-link",{active:u("formateur.disciplines"),"formateur-active":u("formateur.disciplines")}])},{default:f(()=>[e[10]||(e[10]=a("i",{class:"fas fa-graduation-cap w-6 text-teal-500"},null,-1)),(s.value?n.value:o.value)?(t(),l("span",me,"Mes Disciplines")):r("",!0)]),_:1},8,["href","class"])])):r("",!0),i(E)?(t(),l("div",ge,[c(m,{href:i(v)("admin.dashboard"),class:p(["nav-link",{active:u("admin.dashboard")}])},{default:f(()=>[e[11]||(e[11]=a("i",{class:"fas fa-home w-6 text-blue-400"},null,-1)),(s.value?n.value:o.value)?(t(),l("span",xe,"Dashboard Admin")):r("",!0)]),_:1},8,["href","class"]),c(m,{href:i(v)("apprenants.index"),class:p(["nav-link",{active:u("apprenants.index")}])},{default:f(()=>[e[12]||(e[12]=a("i",{class:"fas fa-user-graduate w-6 text-green-400"},null,-1)),(s.value?n.value:o.value)?(t(),l("span",he,"Apprenants")):r("",!0)]),_:1},8,["href","class"]),c(m,{href:i(v)("formateurs.index"),class:p(["nav-link",{active:u("formateurs.index")}])},{default:f(()=>[e[13]||(e[13]=a("i",{class:"fas fa-chalkboard-teacher w-6 text-purple-400"},null,-1)),(s.value?n.value:o.value)?(t(),l("span",ye,"Formateurs")):r("",!0)]),_:1},8,["href","class"]),c(m,{href:i(v)("formations.index"),class:p(["nav-link",{active:u("formations.index")}])},{default:f(()=>[e[14]||(e[14]=a("i",{class:"fas fa-chalkboard w-6 text-orange-400"},null,-1)),(s.value?n.value:o.value)?(t(),l("span",_e,"Formations")):r("",!0)]),_:1},8,["href","class"]),c(m,{href:i(v)("disciplines.index"),class:p(["nav-link",{active:u("disciplines.index")}])},{default:f(()=>[e[15]||(e[15]=a("i",{class:"fas fa-graduation-cap w-6 text-pink-400"},null,-1)),(s.value?n.value:o.value)?(t(),l("span",ke,"Disciplines")):r("",!0)]),_:1},8,["href","class"])])):r("",!0),i(S)&&(s.value?n.value:o.value)?(t(),l("div",be,[e[16]||(e[16]=a("h3",{class:"text-sm font-semibold text-gray-300 mb-3 flex items-center gap-2"},[a("i",{class:"fas fa-bell text-indigo-400"}),D(" Notifications ")],-1)),g.value.length?(t(),l("div",we,[(t(!0),l(O,null,U(g.value,x=>(t(),l("div",{key:x.id,class:"p-3 bg-gray-700 rounded-lg shadow-md hover:bg-gray-600 transition-all duration-200"},[a("p",Ce,w(x.message),1),a("p",Me,w(x.created_at),1),a("button",{onClick:k=>P(x.id),class:"text-indigo-400 hover:text-indigo-300 text-xs mt-2 transition-colors"}," Marquer comme lu ",8,Ae)]))),128))])):(t(),l("p",De,"Aucune notification"))])):r("",!0),a("div",Ne,[A.value?(t(),l("button",{key:0,onClick:W,class:"nav-link w-full text-left bg-indigo-600 hover:bg-indigo-700"},[e[17]||(e[17]=a("i",{class:"fas fa-download w-6 text-white"},null,-1)),(s.value?n.value:o.value)?(t(),l("span",Se,"Installer l’app")):r("",!0)])):r("",!0)])]),a("div",Fe,[c(i(j),null,{default:f(()=>[c(i(R),{"as-child":""},{default:f(()=>[a("button",ze,[a("span",Ee,[e[18]||(e[18]=a("i",{class:"fas fa-user w-6 text-indigo-400"},null,-1)),(s.value?n.value:o.value)?(t(),l("span",Le,"Profil")):r("",!0),g.value.length&&(s.value?n.value:o.value)?(t(),l("span",Pe,w(g.value.length),1)):r("",!0)]),(s.value?n.value:o.value)?(t(),l("i",We)):r("",!0)])]),_:1}),(s.value?n.value:o.value)?(t(),X(i(V),{key:0,class:"bg-gray-800 text-gray-100 rounded-lg shadow-lg w-48"},{default:f(()=>[c(m,{class:"block px-4 py-2 hover:bg-gray-700 transition-all",href:i(v)("profile.edit"),as:"button"},{default:f(()=>e[19]||(e[19]=[D(" Paramètres ")])),_:1},8,["href"]),c(m,{class:"block px-4 py-2 hover:bg-gray-700 transition-all",method:"post",href:i(v)("logout"),as:"button"},{default:f(()=>e[20]||(e[20]=[D(" Déconnexion ")])),_:1},8,["href"])]),_:1})):r("",!0)]),_:1})])])],2),a("main",{class:p(["flex-1 p-4 sm:p-6 bg-gray-800 overflow-y-auto transition-all duration-300 relative",s.value?"ml-0":o.value?"lg:ml-64":"lg:ml-16"])},[s.value&&!n.value?(t(),l("button",{key:0,onClick:N,class:"fixed top-4 left-4 z-30 bg-indigo-600 text-white p-2 rounded-full shadow-lg hover:bg-indigo-700 transition-all"},e[21]||(e[21]=[a("i",{class:"fas fa-bars text-lg"},null,-1)]))):r("",!0),H(d.$slots,"default",{},void 0,!0),e[22]||(e[22]=a("div",{class:"scroll-hint bg-indigo-500 text-white px-3 py-1 rounded-full text-xs"},"Défiler",-1))],2)]))}}),qe=Q($e,[["__scopeId","data-v-3bed098a"]]);export{qe as M};
