import{a as R,b as W,_ as E}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-B5-4KPiL.js";import{d as T,r as w,n as V,l as j,k as z,A as B,e as d,o as u,a as e,p as c,u as a,g as n,w as o,z as f,T as r,t as y,b as C,F as I,f as q,y as G,R as K}from"./app-DYQAJEWz.js";import{_ as i}from"./TextLink.vue_vue_type_script_setup_true_lang-CZLXCsjs.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";const X={class:"min-h-screen bg-gray-900 text-gray-100 flex overflow-hidden"},H={class:"flex flex-col h-full"},J={class:"flex-1 py-4"},Q={key:0,class:"space-y-2"},U={key:0,class:"bg-red-500 text-white text-xs rounded-full px-2 py-0.5 ml-2 animate-pulse"},Y={key:1,class:"space-y-2"},Z={key:2,class:"space-y-2"},ss={key:3,class:"mt-6 px-4"},es={key:0,class:"space-y-3 max-h-64 overflow-y-auto"},as={class:"text-sm text-white"},ts={class:"text-xs text-gray-400 mt-1"},ls=["onClick"],ns={key:1,class:"text-sm text-gray-400 italic"},os={class:"mt-4 px-4"},rs={class:"p-4 mt-auto"},is={class:"flex items-center justify-between w-full px-4 py-3 bg-gray-800 text-gray-200 rounded-lg hover:bg-gray-700 transition-all duration-300"},fs={class:"flex items-center gap-2"},ds={key:0,class:"bg-red-500 text-white text-xs rounded-full px-2 py-0.5 animate-pulse"},us={class:"flex-1 p-4 sm:p-6 bg-gray-800 overflow-y-auto transition-all duration-300 relative animate-fade-in"},ps=T({__name:"MonLayout",setup(cs){var N;const h=w(!1),A=()=>{h.value=!h.value},k=V(),x=k.props.auth.user,F=x&&x.role==="admin",S=x&&x.role==="formateur",D=x&&x.role==="apprenant",p=w(((N=k.props.dashboardData)==null?void 0:N.notifications)||[]);j(()=>{var l;return(l=k.props.dashboardData)==null?void 0:l.notifications},l=>{p.value=l||[]},{immediate:!0});const M=z(()=>p.value.filter(l=>l.type==="note_update").length),P=l=>{var m;const s=(m=document.querySelector('meta[name="csrf-token"]'))==null?void 0:m.content;if(!s){console.error("CSRF token not found");return}K.post(r("notifications.read",l),{},{headers:{"X-CSRF-TOKEN":s}}).then(v=>{v.data.success&&(p.value=p.value.filter(b=>b.id!==l))}).catch(v=>{var b;console.error("Error:",((b=v.response)==null?void 0:b.data)||v.message)})},t=l=>r().current(l),g=w(null),_=w(!1);window.addEventListener("beforeinstallprompt",l=>{l.preventDefault(),g.value=l,_.value=!0});const $=async()=>{if(g.value){g.value.prompt();const{outcome:l}=await g.value.userChoice;console.log(l==="accepted"?"Application installée":"Installation refusée"),g.value=null,_.value=!1}},L=async()=>{if("serviceWorker"in navigator){const l=await navigator.serviceWorker.getRegistrations();for(const s of l)await s.unregister();await navigator.serviceWorker.register("/service-worker.js"),console.log("Service Worker réinitialisé")}};return B(()=>{L()}),(l,s)=>(u(),d("div",X,[e("aside",{class:f(["sidebar flex-shrink-0 bg-gradient-to-b from-gray-800 to-gray-900 shadow-xl transition-all duration-300",h.value?"w-64":"w-0 lg:w-64"])},[e("div",H,[e("div",{class:"p-4 flex items-center justify-between bg-gray-900"},[s[1]||(s[1]=e("div",{class:"flex items-center gap-3"},[e("div",{class:"bg-white p-1 rounded-full shadow-md"},[e("img",{src:"/img/logo.png",alt:"Logo CFPCa",class:"h-10 w-10 rounded-full animate-spin-slow"})]),e("span",{class:"text-lg font-bold text-white"},"CFPCa")],-1)),e("button",{onClick:A,class:"lg:hidden text-gray-200 hover:text-white p-2 rounded-full hover:bg-gray-600 transition-all"},s[0]||(s[0]=[e("i",{class:"fas fa-times text-lg"},null,-1)]))]),e("nav",J,[a(D)?(u(),d("div",Q,[n(i,{href:a(r)("apprenant.dashboard"),class:f(["nav-link",{active:t("apprenant.dashboard")}])},{default:o(()=>s[2]||(s[2]=[e("i",{class:"fas fa-tachometer-alt w-6 text-indigo-400"},null,-1),e("span",{class:"flex-1"},"Dashboard",-1)])),_:1},8,["href","class"]),n(i,{href:a(r)("apprenant.disciplines"),class:f(["nav-link",{active:t("apprenant.disciplines")}])},{default:o(()=>s[3]||(s[3]=[e("i",{class:"fas fa-book-open w-6 text-indigo-400"},null,-1),e("span",{class:"flex-1"},"Mes Disciplines",-1)])),_:1},8,["href","class"]),n(i,{href:a(r)("apprenant.notes"),class:f(["nav-link",{active:t("apprenant.notes")}])},{default:o(()=>[s[4]||(s[4]=e("i",{class:"fas fa-star w-6 text-indigo-400"},null,-1)),s[5]||(s[5]=e("span",{class:"flex-1"},"Mes Notes",-1)),M.value>0?(u(),d("span",U,y(M.value),1)):c("",!0)]),_:1},8,["href","class"]),n(i,{href:a(r)("apprenant.carnet"),class:f(["nav-link",{active:t("apprenant.carnet")}])},{default:o(()=>s[6]||(s[6]=[e("i",{class:"fas fa-book w-6 text-indigo-400"},null,-1),e("span",{class:"flex-1"},"Mon Carnet",-1)])),_:1},8,["href","class"]),n(i,{href:a(r)("apprenant.progression"),class:f(["nav-link",{active:t("apprenant.progression")}])},{default:o(()=>s[7]||(s[7]=[e("i",{class:"fas fa-chart-line w-6 text-indigo-400"},null,-1),e("span",{class:"flex-1"},"Ma Progression",-1)])),_:1},8,["href","class"])])):c("",!0),a(S)?(u(),d("div",Y,[n(i,{href:a(r)("formateur.dashboard"),class:f(["nav-link",{active:t("formateur.dashboard"),"formateur-active":t("formateur.dashboard")}])},{default:o(()=>s[8]||(s[8]=[e("i",{class:"fas fa-tachometer-alt w-6 text-red-400"},null,-1),e("span",{class:"flex-1"},"Dashboard",-1)])),_:1},8,["href","class"]),n(i,{href:a(r)("formateur.formations"),class:f(["nav-link",{active:t("formateur.formations"),"formateur-active":t("formateur.formations")}])},{default:o(()=>s[9]||(s[9]=[e("i",{class:"fas fa-book w-6 text-red-400"},null,-1),e("span",{class:"flex-1"},"Mes Formations",-1)])),_:1},8,["href","class"]),n(i,{href:a(r)("formateur.apprenants"),class:f(["nav-link",{active:t("formateur.apprenants"),"formateur-active":t("formateur.apprenants")}])},{default:o(()=>s[10]||(s[10]=[e("i",{class:"fas fa-users w-6 text-red-400"},null,-1),e("span",{class:"flex-1"},"Mes Apprenants",-1)])),_:1},8,["href","class"]),n(i,{href:a(r)("formateur.notes"),class:f(["nav-link",{active:t("formateur.notes"),"formateur-active":t("formateur.notes")}])},{default:o(()=>s[11]||(s[11]=[e("i",{class:"fas fa-star w-6 text-red-400"},null,-1),e("span",{class:"flex-1"},"Gérer les Notes",-1)])),_:1},8,["href","class"]),n(i,{href:a(r)("formateur.disciplines"),class:f(["nav-link",{active:t("formateur.disciplines"),"formateur-active":t("formateur.disciplines")}])},{default:o(()=>s[12]||(s[12]=[e("i",{class:"fas fa-book-open w-6 text-red-400"},null,-1),e("span",{class:"flex-1"},"Mes Disciplines",-1)])),_:1},8,["href","class"])])):c("",!0),a(F)?(u(),d("div",Z,[n(i,{href:a(r)("admin.dashboard"),class:f(["nav-link",{active:t("admin.dashboard")}])},{default:o(()=>s[13]||(s[13]=[e("i",{class:"fas fa-tachometer-alt w-6 text-white"},null,-1),e("span",{class:"flex-1"},"Dashboard Admin",-1)])),_:1},8,["href","class"]),n(i,{href:a(r)("apprenants.index"),class:f(["nav-link",{active:t("apprenants.index")}])},{default:o(()=>s[14]||(s[14]=[e("i",{class:"fas fa-user-tie w-6 text-white"},null,-1),e("span",{class:"flex-1"},"Apprenants",-1)])),_:1},8,["href","class"]),n(i,{href:a(r)("formateurs.index"),class:f(["nav-link",{active:t("formateurs.index")}])},{default:o(()=>s[15]||(s[15]=[e("i",{class:"fas fa-user-tie w-6 text-white"},null,-1),e("span",{class:"flex-1"},"Formateurs",-1)])),_:1},8,["href","class"]),n(i,{href:a(r)("formations.index"),class:f(["nav-link",{active:t("formations.index")}])},{default:o(()=>s[16]||(s[16]=[e("i",{class:"fas fa-book w-6 text-white"},null,-1),e("span",{class:"flex-1"},"Formations",-1)])),_:1},8,["href","class"]),n(i,{href:a(r)("disciplines.index"),class:f(["nav-link",{active:t("disciplines.index")}])},{default:o(()=>s[17]||(s[17]=[e("i",{class:"fas fa-book-open w-6 text-white"},null,-1),e("span",{class:"flex-1"},"Disciplines",-1)])),_:1},8,["href","class"])])):c("",!0),a(D)?(u(),d("div",ss,[s[18]||(s[18]=e("h3",{class:"text-sm font-semibold text-gray-300 mb-3 flex items-center gap-2"},[e("i",{class:"fas fa-bell text-indigo-400"}),C(" Notifications ")],-1)),p.value.length?(u(),d("div",es,[(u(!0),d(I,null,q(p.value,m=>(u(),d("div",{key:m.id,class:"p-3 bg-gray-700 rounded-lg shadow-md hover:bg-gray-600 transition-all duration-200"},[e("p",as,y(m.message),1),e("p",ts,y(m.created_at),1),e("button",{onClick:v=>P(m.id),class:"text-indigo-400 hover:text-indigo-300 text-xs mt-2 transition-colors"}," Marquer comme lu ",8,ls)]))),128))])):(u(),d("p",ns,"Aucune notification"))])):c("",!0),e("div",os,[_.value?(u(),d("button",{key:0,onClick:$,class:"nav-link w-full text-left bg-indigo-600 hover:bg-indigo-700"},s[19]||(s[19]=[e("i",{class:"fas fa-download w-6 text-white"},null,-1),e("span",{class:"flex-1"},"Installer l’app",-1)]))):c("",!0)])]),e("div",rs,[n(a(E),null,{default:o(()=>[n(a(R),{"as-child":""},{default:o(()=>[e("button",is,[e("span",fs,[s[20]||(s[20]=e("i",{class:"fas fa-user w-6 text-indigo-400"},null,-1)),s[21]||(s[21]=e("span",{class:"flex-1"},"Profil",-1)),p.value.length?(u(),d("span",ds,y(p.value.length),1)):c("",!0)]),s[22]||(s[22]=e("i",{class:"fas fa-chevron-down"},null,-1))])]),_:1}),n(a(W),{class:"bg-gray-800 text-gray-100 rounded-lg shadow-lg w-48"},{default:o(()=>[n(i,{class:"block px-4 py-2 hover:bg-gray-700 transition-all",href:a(r)("profile.edit"),as:"button"},{default:o(()=>s[23]||(s[23]=[C(" Paramètres ")])),_:1},8,["href"]),n(i,{class:"block px-4 py-2 hover:bg-gray-700 transition-all",method:"post",href:a(r)("logout"),as:"button"},{default:o(()=>s[24]||(s[24]=[C(" Déconnexion ")])),_:1},8,["href"])]),_:1})]),_:1})])])],2),e("main",us,[h.value?c("",!0):(u(),d("button",{key:0,onClick:A,class:"lg:hidden fixed top-4 left-4 z-30 bg-indigo-600 text-white p-2 rounded-full shadow-lg hover:bg-indigo-700 transition-all"},s[25]||(s[25]=[e("i",{class:"fas fa-bars text-lg"},null,-1)]))),G(l.$slots,"default",{},void 0,!0),s[26]||(s[26]=e("div",{class:"scroll-hint bg-indigo-500 text-white px-3 py-1 rounded-full text-xs"},"Défiler",-1))])]))}}),hs=O(ps,[["__scopeId","data-v-117e4e39"]]);export{hs as M};
