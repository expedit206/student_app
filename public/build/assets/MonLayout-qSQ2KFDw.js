import{a as q,b as G,_ as K}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BbNmasx3.js";import{d as O,I as U,j as y,s as X,q as H,c as J,A as Q,N as Y,g as l,o as s,b as a,F as L,r as E,h as f,i as o,u as i,e as v,w as c,T as p,t as w,f as D,a as P,z as Z,G as ee,S as ae}from"./app-B32XEERy.js";import{_ as g}from"./TextLink.vue_vue_type_script_setup_true_lang-BDHw2Uln.js";import{S as se,M as te}from"./sun-DRak2UxW.js";import{_ as le}from"./_plugin-vue_export-helper-DlAUqK2U.js";const re={class:"min-h-screen bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 flex overflow-hidden"},ne=["onClick"],oe={class:"flex flex-col h-full"},ie={class:"p-4 flex items-center justify-between bg-gray-300 dark:bg-gray-900"},ue={key:0,class:"flex items-center gap-3"},de={class:"flex-1 py-4"},fe={key:0,class:"space-y-2"},ce={key:0,class:"flex-1"},ve={key:0,class:"flex-1"},pe={key:0,class:"flex-1"},ge={key:1,class:"bg-red-500 text-white text-xs rounded-full px-2 py-0.5 ml-2 animate-pulse"},xe={key:0,class:"flex-1"},me={key:0,class:"flex-1"},he={key:1,class:"space-y-2"},ke={key:0,class:"flex-1"},ye={key:0,class:"flex-1"},be={key:0,class:"flex-1"},_e={key:0,class:"flex-1"},we={key:0,class:"flex-1"},Ce={key:2,class:"space-y-2"},Me={key:0,class:"flex-1"},Ae={key:0,class:"flex-1"},De={key:0,class:"flex-1"},Se={key:0,class:"flex-1"},Ne={key:0,class:"flex-1"},Fe={key:3,class:"mt-6 px-4"},ze={key:0,class:"space-y-3 max-h-64 overflow-y-auto"},Le={class:"text-sm text-gray-900 dark:text-white"},Ee={class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},Pe=["onClick"],$e={key:1,class:"text-sm text-gray-500 dark:text-gray-400 italic"},Ie={class:"mt-4 px-4"},We={key:0,class:"flex-1"},Ve={class:"p-4 mt-auto"},je={class:"flex items-center justify-between w-full px-4 py-3 bg-gray-200 dark:bg-gray-800 text-gray-900 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-700 transition-all duration-300"},Be={class:"flex items-center gap-2"},Re={key:0,class:"flex-1"},Te={key:1,class:"bg-red-500 text-white text-xs rounded-full px-2 py-0.5 animate-pulse"},qe={key:0,class:"fas fa-chevron-down"},Ge=O({__name:"MonLayout",setup(Ke){var z;const{appearance:$,updateAppearance:I}=U(),W=[{value:"light",Icon:se,label:"Light"},{value:"dark",Icon:te,label:"Dark"}],n=y(!0),r=y(!1),t=y(!1),C=()=>{t.value=window.innerWidth<1024,t.value?r.value=!1:r.value=!0},S=()=>{t.value?r.value=!r.value:n.value=!n.value},M=X(),k=M.props.auth.user,V=k&&k.role==="admin",j=k&&k.role==="formateur",N=k&&k.role==="apprenant",m=y(((z=M.props.dashboardData)==null?void 0:z.notifications)||[]);H(()=>{var d;return(d=M.props.dashboardData)==null?void 0:d.notifications},d=>{m.value=d||[]},{immediate:!0});const F=J(()=>m.value.filter(d=>d.type==="note_update").length),B=d=>{var x;const e=(x=document.querySelector('meta[name="csrf-token"]'))==null?void 0:x.content;if(!e){console.error("CSRF token not found");return}ae.post(p("notifications.read",d),{},{headers:{"X-CSRF-TOKEN":e}}).then(h=>{h.data.success&&(m.value=m.value.filter(_=>_.id!==d))}).catch(h=>{var _;console.error("Error:",((_=h.response)==null?void 0:_.data)||h.message)})},u=d=>p().current(d),b=y(null),A=y(!1);window.addEventListener("beforeinstallprompt",d=>{d.preventDefault(),b.value=d,A.value=!0});const R=async()=>{if(b.value){b.value.prompt();const{outcome:d}=await b.value.userChoice;console.log(d==="accepted"?"Application installée":"Installation refusée"),b.value=null,A.value=!1}},T=async()=>{if("serviceWorker"in navigator){const d=await navigator.serviceWorker.getRegistrations();for(const e of d)await e.unregister();await navigator.serviceWorker.register("/service-worker.js"),console.log("Service Worker réinitialisé")}};return Q(()=>{T(),C(),window.addEventListener("resize",C)}),Y(()=>{window.removeEventListener("resize",C)}),(d,e)=>(s(),l("div",re,[a("div",{class:f([["inline-flex gap-1 rounded-lg  p-1"],"fixed top-0 right-0 mt-1 dark:bg-slate-600 bg-slate-300 mr-4 z-10 md:flex"])},[(s(),l(L,null,E(W,({value:x,Icon:h,label:_})=>a("button",{key:x,onClick:Oe=>i(I)(x),class:f(["flex items-center rounded-md px-2 py-[.2rem] transition-colors",i($)===x?"bg-white shadow-sm text-neutral-900 dark:bg-neutral-700 dark:text-neutral-100":"text-neutral-500 hover:bg-neutral-200/60 hover:text-neutral-900 dark:text-neutral-400 dark:hover:bg-neutral-700/60 dark:hover:text-neutral-100"])},[(s(),P(ee(h),{class:"-ml-1 h-4 w-4"}))],10,ne)),64))]),a("aside",{class:f(["sidebar flex-shrink-0 bg-gradient-to-b from-gray-200 dark:from-gray-800 to-gray-300 dark:to-gray-900 shadow-xl transition-all duration-300 fixed top-0 left-0 h-full z-20",{"w-64":!t.value&&n.value||t.value&&r.value,"w-16":!t.value&&!n.value,"w-0":t.value&&!r.value}])},[a("div",oe,[a("div",ie,[!t.value&&n.value||t.value&&r.value?(s(),l("div",ue,e[0]||(e[0]=[a("div",{class:"bg-white p-1 rounded-full shadow-md"},[a("img",{src:"/img/logo.png",alt:"Logo CFPCa",class:"h-10 w-10 rounded-full animate-spin-slow"})],-1),a("span",{class:"text-lg font-bold text-gray-900 dark:text-white"},"CFPCa",-1)]))):o("",!0),a("button",{onClick:S,class:"text-gray-600 dark:text-gray-200 hover:text-gray-900 dark:hover:text-white p-2 rounded-full hover:bg-gray-400 dark:hover:bg-gray-600 transition-all ml-auto"},[a("i",{class:f([t.value?r.value?"fas fa-times":"fas fa-bars":n.value?"fas fa-chevron-left":"fas fa-chevron-right","text-lg"])},null,2)])]),a("nav",de,[i(N)?(s(),l("div",fe,[v(g,{href:i(p)("apprenant.dashboard"),class:f(["nav-link",{active:u("apprenant.dashboard")}])},{default:c(()=>[e[1]||(e[1]=a("i",{class:"fas fa-home w-6 text-cyan-400"},null,-1)),(t.value?r.value:n.value)?(s(),l("span",ce,"Dashboard")):o("",!0)]),_:1},8,["href","class"]),v(g,{href:i(p)("apprenant.disciplines"),class:f(["nav-link",{active:u("apprenant.disciplines")}])},{default:c(()=>[e[2]||(e[2]=a("i",{class:"fas fa-graduation-cap w-6 text-indigo-500"},null,-1)),(t.value?r.value:n.value)?(s(),l("span",ve,"Mes Disciplines")):o("",!0)]),_:1},8,["href","class"]),v(g,{href:i(p)("apprenant.notes"),class:f(["nav-link",{active:u("apprenant.notes")}])},{default:c(()=>[e[3]||(e[3]=a("i",{class:"fas fa-clipboard-check w-6 text-yellow-400"},null,-1)),(t.value?r.value:n.value)?(s(),l("span",pe,"Mes Notes")):o("",!0),F.value>0&&(t.value?r.value:n.value)?(s(),l("span",ge,w(F.value),1)):o("",!0)]),_:1},8,["href","class"]),v(g,{href:i(p)("apprenant.carnet"),class:f(["nav-link",{active:u("apprenant.carnet")}])},{default:c(()=>[e[4]||(e[4]=a("i",{class:"fas fa-address-card w-6 text-green-400"},null,-1)),(t.value?r.value:n.value)?(s(),l("span",xe,"Mon Carnet")):o("",!0)]),_:1},8,["href","class"]),v(g,{href:i(p)("apprenant.progression"),class:f(["nav-link",{active:u("apprenant.progression")}])},{default:c(()=>[e[5]||(e[5]=a("i",{class:"fas fa-arrow-trend-up w-6 text-purple-400"},null,-1)),(t.value?r.value:n.value)?(s(),l("span",me,"Ma Progression")):o("",!0)]),_:1},8,["href","class"])])):o("",!0),i(j)?(s(),l("div",he,[v(g,{href:i(p)("formateur.dashboard"),class:f(["nav-link",{active:u("formateur.dashboard"),"formateur-active":u("formateur.dashboard")}])},{default:c(()=>[e[6]||(e[6]=a("i",{class:"fas fa-home w-6 text-red-500"},null,-1)),(t.value?r.value:n.value)?(s(),l("span",ke,"Dashboard")):o("",!0)]),_:1},8,["href","class"]),v(g,{href:i(p)("formateur.formations"),class:f(["nav-link",{active:u("formateur.formations"),"formateur-active":u("formateur.formations")}])},{default:c(()=>[e[7]||(e[7]=a("i",{class:"fas fa-chalkboard w-6 text-orange-500"},null,-1)),(t.value?r.value:n.value)?(s(),l("span",ye,"Mes Formations")):o("",!0)]),_:1},8,["href","class"]),v(g,{href:i(p)("formateur.apprenants"),class:f(["nav-link",{active:u("formateur.apprenants"),"formateur-active":u("formateur.apprenants")}])},{default:c(()=>[e[8]||(e[8]=a("i",{class:"fas fa-user-graduate w-6 text-yellow-500"},null,-1)),(t.value?r.value:n.value)?(s(),l("span",be,"Mes Apprenants")):o("",!0)]),_:1},8,["href","class"]),v(g,{href:i(p)("formateur.notes"),class:f(["nav-link",{active:u("formateur.notes"),"formateur-active":u("formateur.notes")}])},{default:c(()=>[e[9]||(e[9]=a("i",{class:"fas fa-pen w-6 text-pink-500"},null,-1)),(t.value?r.value:n.value)?(s(),l("span",_e,"Gérer les Notes")):o("",!0)]),_:1},8,["href","class"]),v(g,{href:i(p)("formateur.disciplines"),class:f(["nav-link",{active:u("formateur.disciplines"),"formateur-active":u("formateur.disciplines")}])},{default:c(()=>[e[10]||(e[10]=a("i",{class:"fas fa-graduation-cap w-6 text-teal-500"},null,-1)),(t.value?r.value:n.value)?(s(),l("span",we,"Mes Disciplines")):o("",!0)]),_:1},8,["href","class"])])):o("",!0),i(V)?(s(),l("div",Ce,[v(g,{href:i(p)("admin.dashboard"),class:f(["nav-link",{active:u("admin.dashboard")}])},{default:c(()=>[e[11]||(e[11]=a("i",{class:"fas fa-home w-6 text-blue-400"},null,-1)),(t.value?r.value:n.value)?(s(),l("span",Me,"Dashboard Admin")):o("",!0)]),_:1},8,["href","class"]),v(g,{href:i(p)("apprenants.index"),class:f(["nav-link",{active:u("apprenants.index")}])},{default:c(()=>[e[12]||(e[12]=a("i",{class:"fas fa-user-graduate w-6 text-green-400"},null,-1)),(t.value?r.value:n.value)?(s(),l("span",Ae,"Apprenants")):o("",!0)]),_:1},8,["href","class"]),v(g,{href:i(p)("formateurs.index"),class:f(["nav-link",{active:u("formateurs.index")}])},{default:c(()=>[e[13]||(e[13]=a("i",{class:"fas fa-chalkboard-teacher w-6 text-purple-400"},null,-1)),(t.value?r.value:n.value)?(s(),l("span",De,"Formateurs")):o("",!0)]),_:1},8,["href","class"]),v(g,{href:i(p)("formations.index"),class:f(["nav-link",{active:u("formations.index")}])},{default:c(()=>[e[14]||(e[14]=a("i",{class:"fas fa-chalkboard w-6 text-orange-400"},null,-1)),(t.value?r.value:n.value)?(s(),l("span",Se,"Formations")):o("",!0)]),_:1},8,["href","class"]),v(g,{href:i(p)("disciplines.index"),class:f(["nav-link",{active:u("disciplines.index")}])},{default:c(()=>[e[15]||(e[15]=a("i",{class:"fas fa-graduation-cap w-6 text-pink-400"},null,-1)),(t.value?r.value:n.value)?(s(),l("span",Ne,"Disciplines")):o("",!0)]),_:1},8,["href","class"])])):o("",!0),i(N)&&(t.value?r.value:n.value)?(s(),l("div",Fe,[e[16]||(e[16]=a("h3",{class:"text-sm font-semibold text-gray-600 dark:text-gray-300 mb-3 flex items-center gap-2"},[a("i",{class:"fas fa-bell text-indigo-400"}),D(" Notifications ")],-1)),m.value.length?(s(),l("div",ze,[(s(!0),l(L,null,E(m.value,x=>(s(),l("div",{key:x.id,class:"p-3 bg-gray-200 dark:bg-gray-700 rounded-lg shadow-md hover:bg-gray-300 dark:hover:bg-gray-600 transition-all duration-200"},[a("p",Le,w(x.message),1),a("p",Ee,w(x.created_at),1),a("button",{onClick:h=>B(x.id),class:"text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-300 text-xs mt-2 transition-colors"}," Marquer comme lu ",8,Pe)]))),128))])):(s(),l("p",$e,"Aucune notification"))])):o("",!0),a("div",Ie,[A.value?(s(),l("button",{key:0,onClick:R,class:"nav-link w-full text-left bg-indigo-600 hover:bg-indigo-700 dark:bg-indigo-500 dark:hover:bg-indigo-600"},[e[17]||(e[17]=a("i",{class:"fas fa-download w-6 text-white"},null,-1)),(t.value?r.value:n.value)?(s(),l("span",We,"Installer l’app")):o("",!0)])):o("",!0)])]),a("div",Ve,[v(i(K),null,{default:c(()=>[v(i(q),{"as-child":""},{default:c(()=>[a("button",je,[a("span",Be,[e[18]||(e[18]=a("i",{class:"fas fa-user w-6 text-indigo-400"},null,-1)),(t.value?r.value:n.value)?(s(),l("span",Re,"Profil")):o("",!0),m.value.length&&(t.value?r.value:n.value)?(s(),l("span",Te,w(m.value.length),1)):o("",!0)]),(t.value?r.value:n.value)?(s(),l("i",qe)):o("",!0)])]),_:1}),(t.value?r.value:n.value)?(s(),P(i(G),{key:0,class:"bg-gray-200 dark:bg-gray-800 text-gray-900 dark:text-gray-100 rounded-lg shadow-lg w-48"},{default:c(()=>[v(g,{class:"block px-4 py-2 hover:bg-gray-300 dark:hover:bg-gray-700 transition-all",href:i(p)("profile.edit"),as:"button"},{default:c(()=>e[19]||(e[19]=[D(" Paramètres ")])),_:1},8,["href"]),v(g,{class:"block px-4 py-2 hover:bg-gray-300 dark:hover:bg-gray-700 transition-all",method:"post",href:i(p)("logout"),as:"button"},{default:c(()=>e[20]||(e[20]=[D(" Déconnexion ")])),_:1},8,["href"])]),_:1})):o("",!0)]),_:1})])])],2),a("main",{class:f(["flex-1 p-4 sm:p-6 bg-gray-50 dark:bg-gray-800 overflow-y-auto transition-all duration-300 relative",t.value?"ml-0":n.value?"lg:ml-64":"lg:ml-16"])},[t.value&&!r.value?(s(),l("button",{key:0,onClick:S,class:"fixed top-4 left-4 z-30 bg-indigo-600 text-white p-2 rounded-full shadow-lg hover:bg-indigo-700 dark:bg-indigo-500 dark:hover:bg-indigo-600 transition-all"},e[21]||(e[21]=[a("i",{class:"fas fa-bars text-lg"},null,-1)]))):o("",!0),Z(d.$slots,"default",{},void 0,!0),e[22]||(e[22]=a("div",{class:"scroll-hint bg-indigo-500 dark:bg-indigo-400 text-white px-3 py-1 rounded-full text-xs"},"Défiler ",-1))],2)]))}}),Ye=le(Ge,[["__scopeId","data-v-73623925"]]);export{Ye as M};
