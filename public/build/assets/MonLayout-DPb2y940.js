import{a as j,b as L,_ as z}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-CH-SlJh5.js";import{d as E,r as b,n as R,l as T,k as V,A as B,e as d,o as u,a as e,p as m,u as a,g as l,w as n,z as f,T as r,t as w,b as k,F as q,f as I,y as G,R as K}from"./app-C_j1LqwD.js";import{_ as i}from"./TextLink.vue_vue_type_script_setup_true_lang-CVP-jFSD.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";const X={class:"min-h-screen bg-gray-900 text-gray-100 flex overflow-hidden"},H={class:"flex flex-col h-full"},J={class:"flex-1 py-4"},Q={key:0,class:"space-y-2"},U={key:0,class:"bg-red-500 text-white text-xs rounded-full px-2 py-0.5 ml-2 animate-pulse"},W={key:1,class:"space-y-2"},Y={key:2,class:"space-y-2"},Z={key:3,class:"mt-6 px-4"},ss={key:0,class:"space-y-3 max-h-64 overflow-y-auto"},es={class:"text-sm text-white"},as={class:"text-xs text-gray-400 mt-1"},ts=["onClick"],ls={key:1,class:"text-sm text-gray-400 italic"},ns={class:"mt-4 px-4"},rs={class:"p-4 mt-auto"},os={class:"flex items-center justify-between w-full px-4 py-3 bg-gray-800 text-gray-200 rounded-lg hover:bg-gray-700 transition-all duration-300"},is={class:"flex items-center gap-2"},fs={key:0,class:"bg-red-500 text-white text-xs rounded-full px-2 py-0.5 animate-pulse"},ds={class:"flex-1 p-4 sm:p-6 bg-gray-800 overflow-y-auto transition-all duration-300 relative animate-fade-in"},us=E({__name:"MonLayout",setup(ps){var M;const v=b(!1),_=()=>{v.value=!v.value},y=R(),x=y.props.auth.user,F=x&&x.role==="admin",N=x&&x.role==="formateur",C=x&&x.role==="apprenant",c=b(((M=y.props.dashboardData)==null?void 0:M.notifications)||[]);T(()=>{var o;return(o=y.props.dashboardData)==null?void 0:o.notifications},o=>{c.value=o||[]},{immediate:!0});const A=V(()=>c.value.filter(o=>o.type==="note_update").length),S=o=>{var p;const s=(p=document.querySelector('meta[name="csrf-token"]'))==null?void 0:p.content;if(!s){console.error("CSRF token not found");return}K.post(r("notifications.read",o),{},{headers:{"X-CSRF-TOKEN":s}}).then(g=>{g.data.success&&(c.value=c.value.filter(h=>h.id!==o))}).catch(g=>{var h;console.error("Error:",((h=g.response)==null?void 0:h.data)||g.message)})},t=o=>r().current(o),P=b(null),D=b(!1);window.addEventListener("beforeinstallprompt",o=>{o.preventDefault(),P.value=o,D.value=!0}),B(()=>{});const $=()=>{alert('Ajoutez cette page à votre écran d’accueil via le menu du navigateur (ex. "Ajouter à l’écran d’accueil" sur Chrome).')};return(o,s)=>(u(),d("div",X,[e("aside",{class:f(["sidebar flex-shrink-0 bg-gradient-to-b from-gray-800 to-gray-900 shadow-xl transition-all duration-300",v.value?"w-64":"w-0 lg:w-64"])},[e("div",H,[e("div",{class:"p-4 flex items-center justify-between bg-gray-900"},[s[2]||(s[2]=e("div",{class:"flex items-center gap-3"},[e("div",{class:"bg-white p-1 rounded-full shadow-md"},[e("img",{src:"/img/logo.png",alt:"Logo CFPCa",class:"h-10 w-10 rounded-full animate-spin-slow"})]),e("span",{class:"text-lg font-bold text-white"},"CFPCa")],-1)),e("button",{onClick:_,class:"lg:hidden text-gray-200 hover:text-white p-2 rounded-full hover:bg-gray-600 transition-all"},s[1]||(s[1]=[e("i",{class:"fas fa-times text-lg"},null,-1)]))]),e("nav",J,[a(C)?(u(),d("div",Q,[l(i,{href:a(r)("apprenant.dashboard"),class:f(["nav-link",{active:t("apprenant.dashboard")}])},{default:n(()=>s[3]||(s[3]=[e("i",{class:"fas fa-tachometer-alt w-6 text-indigo-400"},null,-1),e("span",{class:"flex-1"},"Dashboard",-1)])),_:1},8,["href","class"]),l(i,{href:a(r)("apprenant.disciplines"),class:f(["nav-link",{active:t("apprenant.disciplines")}])},{default:n(()=>s[4]||(s[4]=[e("i",{class:"fas fa-book-open w-6 text-indigo-400"},null,-1),e("span",{class:"flex-1"},"Mes Disciplines",-1)])),_:1},8,["href","class"]),l(i,{href:a(r)("apprenant.notes"),class:f(["nav-link",{active:t("apprenant.notes")}])},{default:n(()=>[s[5]||(s[5]=e("i",{class:"fas fa-star w-6 text-indigo-400"},null,-1)),s[6]||(s[6]=e("span",{class:"flex-1"},"Mes Notes",-1)),A.value>0?(u(),d("span",U,w(A.value),1)):m("",!0)]),_:1},8,["href","class"]),l(i,{href:a(r)("apprenant.carnet"),class:f(["nav-link",{active:t("apprenant.carnet")}])},{default:n(()=>s[7]||(s[7]=[e("i",{class:"fas fa-book w-6 text-indigo-400"},null,-1),e("span",{class:"flex-1"},"Mon Carnet",-1)])),_:1},8,["href","class"]),l(i,{href:a(r)("apprenant.progression"),class:f(["nav-link",{active:t("apprenant.progression")}])},{default:n(()=>s[8]||(s[8]=[e("i",{class:"fas fa-chart-line w-6 text-indigo-400"},null,-1),e("span",{class:"flex-1"},"Ma Progression",-1)])),_:1},8,["href","class"])])):m("",!0),a(N)?(u(),d("div",W,[l(i,{href:a(r)("formateur.dashboard"),class:f(["nav-link",{active:t("formateur.dashboard"),"formateur-active":t("formateur.dashboard")}])},{default:n(()=>s[9]||(s[9]=[e("i",{class:"fas fa-tachometer-alt w-6 text-red-400"},null,-1),e("span",{class:"flex-1"},"Dashboard",-1)])),_:1},8,["href","class"]),l(i,{href:a(r)("formateur.formations"),class:f(["nav-link",{active:t("formateur.formations"),"formateur-active":t("formateur.formations")}])},{default:n(()=>s[10]||(s[10]=[e("i",{class:"fas fa-book w-6 text-red-400"},null,-1),e("span",{class:"flex-1"},"Mes Formations",-1)])),_:1},8,["href","class"]),l(i,{href:a(r)("formateur.apprenants"),class:f(["nav-link",{active:t("formateur.apprenants"),"formateur-active":t("formateur.apprenants")}])},{default:n(()=>s[11]||(s[11]=[e("i",{class:"fas fa-users w-6 text-red-400"},null,-1),e("span",{class:"flex-1"},"Mes Apprenants",-1)])),_:1},8,["href","class"]),l(i,{href:a(r)("formateur.notes"),class:f(["nav-link",{active:t("formateur.notes"),"formateur-active":t("formateur.notes")}])},{default:n(()=>s[12]||(s[12]=[e("i",{class:"fas fa-star w-6 text-red-400"},null,-1),e("span",{class:"flex-1"},"Gérer les Notes",-1)])),_:1},8,["href","class"]),l(i,{href:a(r)("formateur.disciplines"),class:f(["nav-link",{active:t("formateur.disciplines"),"formateur-active":t("formateur.disciplines")}])},{default:n(()=>s[13]||(s[13]=[e("i",{class:"fas fa-book-open w-6 text-red-400"},null,-1),e("span",{class:"flex-1"},"Mes Disciplines",-1)])),_:1},8,["href","class"])])):m("",!0),a(F)?(u(),d("div",Y,[l(i,{href:a(r)("admin.dashboard"),class:f(["nav-link",{active:t("admin.dashboard")}])},{default:n(()=>s[14]||(s[14]=[e("i",{class:"fas fa-tachometer-alt w-6 text-white"},null,-1),e("span",{class:"flex-1"},"Dashboard Admin",-1)])),_:1},8,["href","class"]),l(i,{href:a(r)("apprenants.index"),class:f(["nav-link",{active:t("apprenants.index")}])},{default:n(()=>s[15]||(s[15]=[e("i",{class:"fas fa-user-tie w-6 text-white"},null,-1),e("span",{class:"flex-1"},"Apprenants",-1)])),_:1},8,["href","class"]),l(i,{href:a(r)("formateurs.index"),class:f(["nav-link",{active:t("formateurs.index")}])},{default:n(()=>s[16]||(s[16]=[e("i",{class:"fas fa-user-tie w-6 text-white"},null,-1),e("span",{class:"flex-1"},"Formateurs",-1)])),_:1},8,["href","class"]),l(i,{href:a(r)("formations.index"),class:f(["nav-link",{active:t("formations.index")}])},{default:n(()=>s[17]||(s[17]=[e("i",{class:"fas fa-book w-6 text-white"},null,-1),e("span",{class:"flex-1"},"Formations",-1)])),_:1},8,["href","class"]),l(i,{href:a(r)("disciplines.index"),class:f(["nav-link",{active:t("disciplines.index")}])},{default:n(()=>s[18]||(s[18]=[e("i",{class:"fas fa-book-open w-6 text-white"},null,-1),e("span",{class:"flex-1"},"Disciplines",-1)])),_:1},8,["href","class"])])):m("",!0),a(C)?(u(),d("div",Z,[s[19]||(s[19]=e("h3",{class:"text-sm font-semibold text-gray-300 mb-3 flex items-center gap-2"},[e("i",{class:"fas fa-bell text-indigo-400"}),k(" Notifications ")],-1)),c.value.length?(u(),d("div",ss,[(u(!0),d(q,null,I(c.value,p=>(u(),d("div",{key:p.id,class:"p-3 bg-gray-700 rounded-lg shadow-md hover:bg-gray-600 transition-all duration-200"},[e("p",es,w(p.message),1),e("p",as,w(p.created_at),1),e("button",{onClick:g=>S(p.id),class:"text-indigo-400 hover:text-indigo-300 text-xs mt-2 transition-colors"}," Marquer comme lu ",8,ts)]))),128))])):(u(),d("p",ls,"Aucune notification"))])):m("",!0),e("div",ns,[D.value?(u(),d("button",{key:0,onClick:s[0]||(s[0]=(...p)=>o.installApp&&o.installApp(...p)),class:"nav-link w-full text-left bg-indigo-600 hover:bg-indigo-700"},s[20]||(s[20]=[e("i",{class:"fas fa-download w-6 text-white"},null,-1),e("span",{class:"flex-1"},"Installer l’app",-1)]))):(u(),d("button",{key:1,onClick:$,class:"nav-link w-full text-left bg-gray-600 hover:bg-gray-700"},s[21]||(s[21]=[e("i",{class:"fas fa-plus w-6 text-white"},null,-1),e("span",{class:"flex-1"},"Ajouter manuellement",-1)])))])]),e("div",rs,[l(a(z),null,{default:n(()=>[l(a(j),{"as-child":""},{default:n(()=>[e("button",os,[e("span",is,[s[22]||(s[22]=e("i",{class:"fas fa-user w-6 text-indigo-400"},null,-1)),s[23]||(s[23]=e("span",{class:"flex-1"},"Profil",-1)),c.value.length?(u(),d("span",fs,w(c.value.length),1)):m("",!0)]),s[24]||(s[24]=e("i",{class:"fas fa-chevron-down"},null,-1))])]),_:1}),l(a(L),{class:"bg-gray-800 text-gray-100 rounded-lg shadow-lg w-48"},{default:n(()=>[l(i,{class:"block px-4 py-2 hover:bg-gray-700 transition-all",href:a(r)("profile.edit"),as:"button"},{default:n(()=>s[25]||(s[25]=[k(" Paramètres ")])),_:1},8,["href"]),l(i,{class:"block px-4 py-2 hover:bg-gray-700 transition-all",method:"post",href:a(r)("logout"),as:"button"},{default:n(()=>s[26]||(s[26]=[k(" Déconnexion ")])),_:1},8,["href"])]),_:1})]),_:1})])])],2),e("main",ds,[v.value?m("",!0):(u(),d("button",{key:0,onClick:_,class:"lg:hidden fixed top-4 left-4 z-30 bg-indigo-600 text-white p-2 rounded-full shadow-lg hover:bg-indigo-700 transition-all"},s[27]||(s[27]=[e("i",{class:"fas fa-bars text-lg"},null,-1)]))),G(o.$slots,"default",{},void 0,!0),s[28]||(s[28]=e("div",{class:"scroll-hint bg-indigo-500 text-white px-3 py-1 rounded-full text-xs"},"Défiler",-1))])]))}}),vs=O(us,[["__scopeId","data-v-efc8eb2d"]]);export{vs as M};
