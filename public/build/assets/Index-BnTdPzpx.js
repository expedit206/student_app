import{d as h,r as x,A as C,k as N,c as F,o as a,w as S,a as o,e as l,b as y,i as b,F as c,f as p,t as v,j as $,p as B,q as V,H as z,v as M,W as I,T as A}from"./app-B8cP6UDv.js";import{M as D}from"./MonLayout-CiadOcLl.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BuqfFplo.js";import"./utils-DIVxzRO3.js";import"./TextLink.vue_vue_type_script_setup_true_lang-CRGwyA9q.js";const K={class:"p-6 bg-gray-900 text-gray-100 min-h-screen overflow-hidden"},T={class:"mb-8 animate-fade-up"},L={class:"relative max-w-md"},U=["value"],W={key:0,class:"bg-gray-800 rounded-xl shadow-2xl overflow-hidden transform transition-all duration-500 hover:shadow-[0_0_15px_rgba(59,130,246,0.5)]"},j={class:"min-w-full"},q={class:"bg-gradient-to-r from-gray-700 to-gray-800 text-gray-200 animate-slide-in"},G={class:"py-4 px-6 text-gray-100 sticky left-0 bg-gray-800 z-10"},H={key:0,class:"flex items-center gap-2"},J=["onBlur","onKeyup"],O=["onClick"],P=["onClick"],Q={key:0,class:"p-6 text-center text-gray-400 animate-pulse"},R={key:1,class:"text-center text-gray-400 animate-pulse"},X=h({__name:"Index",props:{formations:{},selectedFormation:{}},setup(k){const u=k,r=x(u.selectedFormation),n=x(null);C(()=>{!r.value&&u.formations.length>0&&(r.value=u.formations[0].id)});const m=N(()=>u.formations.find(i=>i.id===r.value)||{apprenants:[],disciplines:[]}),_=i=>{r.value=i},w=(i,e,t)=>{n.value={apprenantId:i,disciplineId:e,value:t}},g=(i,e)=>{n.value&&n.value.value!==null&&r.value?I.post(A("formateur.updateNote"),{apprenant_id:i,formation_id:r.value,discipline_id:e,note:n.value.value},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{const t=u.formations.find(s=>s.id===r.value),f=t==null?void 0:t.apprenants.find(s=>s.id===i);f&&(f.notes[e]=n.value.value),n.value=null},onError:()=>{n.value=null}}):n.value=null};return(i,e)=>(a(),F(D,null,{default:S(()=>[o("div",K,[e[12]||(e[12]=o("h1",{class:"text-3xl font-extrabold mb-8 flex items-center animate-slide-in"},[o("i",{class:"fas fa-star mr-3 text-yellow-400 text-4xl animate-spin-slow"}),y(" Gestion des Notes ")],-1)),o("div",T,[o("div",L,[e[5]||(e[5]=o("i",{class:"fas fa-graduation-cap absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 animate-pulse"},null,-1)),b(o("select",{"onUpdate:modelValue":e[0]||(e[0]=t=>r.value=t),onChange:e[1]||(e[1]=t=>_(r.value)),class:"w-full pl-12 pr-10 py-3 bg-gray-800 border border-gray-700 rounded-lg text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none shadow-md hover:shadow-xl transition-all duration-300 hover:bg-gray-700"},[e[4]||(e[4]=o("option",{value:null},"Sélectionnez une formation",-1)),(a(!0),l(c,null,p(u.formations,t=>(a(),l("option",{key:t.id,value:t.id},v(t.titre),9,U))),128))],544),[[$,r.value]]),e[6]||(e[6]=o("i",{class:"fas fa-chevron-down absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400 animate-bounce pointer-events-none"},null,-1))])]),r.value?(a(),l("div",W,[o("table",j,[o("thead",null,[o("tr",q,[e[7]||(e[7]=o("th",{class:"py-4 px-6 text-left font-semibold sticky left-0 bg-gray-800 z-10"},"Apprenant",-1)),(a(!0),l(c,null,p(m.value.disciplines,t=>(a(),l("th",{key:t.id,class:"py-4 px-6 text-left font-semibold"},v(t.nom),1))),128))])]),o("tbody",null,[(a(!0),l(c,null,p(m.value.apprenants,(t,f)=>(a(),l("tr",{key:t.id,class:"border-b border-gray-700 hover:bg-gray-700 transition-all duration-300 animate-row-in",style:V({animationDelay:`${.1+f*.1}s`})},[o("td",G,v(t.prenom)+" "+v(t.nom),1),(a(!0),l(c,null,p(m.value.disciplines,s=>(a(),l("td",{key:s.id,class:"py-4 px-6 text-gray-100"},[n.value&&n.value.apprenantId===t.id&&n.value.disciplineId===s.id?(a(),l("div",H,[b(o("input",{"onUpdate:modelValue":e[2]||(e[2]=d=>n.value.value=d),type:"number",min:"0",max:"20",step:"0.01",class:"w-20 p-2 bg-gray-700 border border-gray-600 rounded text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",onBlur:d=>g(t.id,s.id),onKeyup:z(d=>g(t.id,s.id),["enter"]),ref_for:!0,ref:"noteInput",autofocus:""},null,40,J),[[M,n.value.value]]),o("button",{onClick:d=>g(t.id,s.id),class:"text-green-400 hover:text-green-300"},e[8]||(e[8]=[o("i",{class:"fas fa-check"},null,-1)]),8,O),o("button",{onClick:e[3]||(e[3]=d=>n.value=null),class:"text-red-400 hover:text-red-300"},e[9]||(e[9]=[o("i",{class:"fas fa-times"},null,-1)]))])):(a(),l("span",{key:1,class:"cursor-pointer",onClick:d=>w(t.id,s.id,t.notes[s.id]||null)},v(t.notes[s.id]!==void 0&&t.notes[s.id]!==null?t.notes[s.id]+"/20":"Non noté"),9,P))]))),128))],4))),128))])]),m.value.apprenants.length===0?(a(),l("div",Q,e[10]||(e[10]=[o("i",{class:"fas fa-exclamation-circle mr-2 text-xl animate-bounce"},null,-1),y(" Aucun apprenant trouvé pour cette formation ")]))):B("",!0)])):(a(),l("div",R,e[11]||(e[11]=[o("i",{class:"fas fa-info-circle mr-2 text-xl animate-bounce"},null,-1),y(" Veuillez sélectionner une formation pour voir les notes ")])))])]),_:1}))}}),se=E(X,[["__scopeId","data-v-71d83408"]]);export{se as default};
