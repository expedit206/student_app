import{a as R,b as W,_ as z}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DbSrxcCB.js";import{d as E,r as w,n as T,l as V,k as B,A as I,e as d,o as u,a as e,p as m,u as a,g as n,w as r,z as f,T as o,t as k,b as C,F as q,f as G,y as K,R as O}from"./app-C5mAe3Cb.js";import{_ as i}from"./TextLink.vue_vue_type_script_setup_true_lang-BCkI4tni.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";const H={class:"min-h-screen bg-gray-900 text-gray-100 flex overflow-hidden"},J={class:"flex flex-col h-full"},Q={class:"flex-1 py-4"},U={key:0,class:"space-y-2"},Y={key:0,class:"bg-red-500 text-white text-xs rounded-full px-2 py-0.5 ml-2 animate-pulse"},Z={key:1,class:"space-y-2"},ss={key:2,class:"space-y-2"},es={key:3,class:"mt-6 px-4"},as={key:0,class:"space-y-3 max-h-64 overflow-y-auto"},ts={class:"text-sm text-white"},ls={class:"text-xs text-gray-400 mt-1"},ns=["onClick"],rs={key:1,class:"text-sm text-gray-400 italic"},os={class:"mt-4 px-4"},is={class:"p-4 mt-auto"},fs={class:"flex items-center justify-between w-full px-4 py-3 bg-gray-800 text-gray-200 rounded-lg hover:bg-gray-700 transition-all duration-300"},ds={class:"flex items-center gap-2"},us={key:0,class:"bg-red-500 text-white text-xs rounded-full px-2 py-0.5 animate-pulse"},cs={class:"flex-1 p-4 sm:p-6 bg-gray-800 overflow-y-auto transition-all duration-300 relative animate-fade-in"},ps=E({__name:"MonLayout",setup(ms){var F;const h=w(!1),A=()=>{h.value=!h.value},y=T(),g=y.props.auth.user,N=g&&g.role==="admin",S=g&&g.role==="formateur",D=g&&g.role==="apprenant",c=w(((F=y.props.dashboardData)==null?void 0:F.notifications)||[]);V(()=>{var l;return(l=y.props.dashboardData)==null?void 0:l.notifications},l=>{c.value=l||[]},{immediate:!0});const M=B(()=>c.value.filter(l=>l.type==="note_update").length),P=l=>{var p;const s=(p=document.querySelector('meta[name="csrf-token"]'))==null?void 0:p.content;if(!s){console.error("CSRF token not found");return}O.post(o("notifications.read",l),{},{headers:{"X-CSRF-TOKEN":s}}).then(v=>{v.data.success&&(c.value=c.value.filter(b=>b.id!==l))}).catch(v=>{var b;console.error("Error:",((b=v.response)==null?void 0:b.data)||v.message)})},t=l=>o().current(l),x=w(null),_=w(!1);window.addEventListener("beforeinstallprompt",l=>{l.preventDefault(),x.value=l,_.value=!0,alert("kk")});const j=async()=>{if(x.value){x.value.prompt();const{outcome:l}=await x.value.userChoice;console.log(l==="accepted"?"Application installée":"Installation refusée"),x.value=null,_.value=!1}},$=async()=>{if("serviceWorker"in navigator){const l=await navigator.serviceWorker.getRegistrations();for(const s of l)await s.unregister();await navigator.serviceWorker.register("/service-worker.js"),console.log("Service Worker réinitialisé")}};I(()=>{$()});const L=()=>{alert('Ajoutez cette page à votre écran d’accueil via le menu du navigateur (ex. "Ajouter à l’écran d’accueil" sur Chrome).')};return(l,s)=>(u(),d("div",H,[e("aside",{class:f(["sidebar flex-shrink-0 bg-gradient-to-b from-gray-800 to-gray-900 shadow-xl transition-all duration-300",h.value?"w-64":"w-0 lg:w-64"])},[e("div",J,[e("div",{class:"p-4 flex items-center justify-between bg-gray-900"},[s[1]||(s[1]=e("div",{class:"flex items-center gap-3"},[e("div",{class:"bg-white p-1 rounded-full shadow-md"},[e("img",{src:"/img/logo.png",alt:"Logo CFPCa",class:"h-10 w-10 rounded-full animate-spin-slow"})]),e("span",{class:"text-lg font-bold text-white"},"CFPCa")],-1)),e("button",{onClick:A,class:"lg:hidden text-gray-200 hover:text-white p-2 rounded-full hover:bg-gray-600 transition-all"},s[0]||(s[0]=[e("i",{class:"fas fa-times text-lg"},null,-1)]))]),e("nav",Q,[a(D)?(u(),d("div",U,[n(i,{href:a(o)("apprenant.dashboard"),class:f(["nav-link",{active:t("apprenant.dashboard")}])},{default:r(()=>s[2]||(s[2]=[e("i",{class:"fas fa-tachometer-alt w-6 text-indigo-400"},null,-1),e("span",{class:"flex-1"},"Dashboard",-1)])),_:1},8,["href","class"]),n(i,{href:a(o)("apprenant.disciplines"),class:f(["nav-link",{active:t("apprenant.disciplines")}])},{default:r(()=>s[3]||(s[3]=[e("i",{class:"fas fa-book-open w-6 text-indigo-400"},null,-1),e("span",{class:"flex-1"},"Mes Disciplines",-1)])),_:1},8,["href","class"]),n(i,{href:a(o)("apprenant.notes"),class:f(["nav-link",{active:t("apprenant.notes")}])},{default:r(()=>[s[4]||(s[4]=e("i",{class:"fas fa-star w-6 text-indigo-400"},null,-1)),s[5]||(s[5]=e("span",{class:"flex-1"},"Mes Notes",-1)),M.value>0?(u(),d("span",Y,k(M.value),1)):m("",!0)]),_:1},8,["href","class"]),n(i,{href:a(o)("apprenant.carnet"),class:f(["nav-link",{active:t("apprenant.carnet")}])},{default:r(()=>s[6]||(s[6]=[e("i",{class:"fas fa-book w-6 text-indigo-400"},null,-1),e("span",{class:"flex-1"},"Mon Carnet",-1)])),_:1},8,["href","class"]),n(i,{href:a(o)("apprenant.progression"),class:f(["nav-link",{active:t("apprenant.progression")}])},{default:r(()=>s[7]||(s[7]=[e("i",{class:"fas fa-chart-line w-6 text-indigo-400"},null,-1),e("span",{class:"flex-1"},"Ma Progression",-1)])),_:1},8,["href","class"])])):m("",!0),a(S)?(u(),d("div",Z,[n(i,{href:a(o)("formateur.dashboard"),class:f(["nav-link",{active:t("formateur.dashboard"),"formateur-active":t("formateur.dashboard")}])},{default:r(()=>s[8]||(s[8]=[e("i",{class:"fas fa-tachometer-alt w-6 text-red-400"},null,-1),e("span",{class:"flex-1"},"Dashboard",-1)])),_:1},8,["href","class"]),n(i,{href:a(o)("formateur.formations"),class:f(["nav-link",{active:t("formateur.formations"),"formateur-active":t("formateur.formations")}])},{default:r(()=>s[9]||(s[9]=[e("i",{class:"fas fa-book w-6 text-red-400"},null,-1),e("span",{class:"flex-1"},"Mes Formations",-1)])),_:1},8,["href","class"]),n(i,{href:a(o)("formateur.apprenants"),class:f(["nav-link",{active:t("formateur.apprenants"),"formateur-active":t("formateur.apprenants")}])},{default:r(()=>s[10]||(s[10]=[e("i",{class:"fas fa-users w-6 text-red-400"},null,-1),e("span",{class:"flex-1"},"Mes Apprenants",-1)])),_:1},8,["href","class"]),n(i,{href:a(o)("formateur.notes"),class:f(["nav-link",{active:t("formateur.notes"),"formateur-active":t("formateur.notes")}])},{default:r(()=>s[11]||(s[11]=[e("i",{class:"fas fa-star w-6 text-red-400"},null,-1),e("span",{class:"flex-1"},"Gérer les Notes",-1)])),_:1},8,["href","class"]),n(i,{href:a(o)("formateur.disciplines"),class:f(["nav-link",{active:t("formateur.disciplines"),"formateur-active":t("formateur.disciplines")}])},{default:r(()=>s[12]||(s[12]=[e("i",{class:"fas fa-book-open w-6 text-red-400"},null,-1),e("span",{class:"flex-1"},"Mes Disciplines",-1)])),_:1},8,["href","class"])])):m("",!0),a(N)?(u(),d("div",ss,[n(i,{href:a(o)("admin.dashboard"),class:f(["nav-link",{active:t("admin.dashboard")}])},{default:r(()=>s[13]||(s[13]=[e("i",{class:"fas fa-tachometer-alt w-6 text-white"},null,-1),e("span",{class:"flex-1"},"Dashboard Admin",-1)])),_:1},8,["href","class"]),n(i,{href:a(o)("apprenants.index"),class:f(["nav-link",{active:t("apprenants.index")}])},{default:r(()=>s[14]||(s[14]=[e("i",{class:"fas fa-user-tie w-6 text-white"},null,-1),e("span",{class:"flex-1"},"Apprenants",-1)])),_:1},8,["href","class"]),n(i,{href:a(o)("formateurs.index"),class:f(["nav-link",{active:t("formateurs.index")}])},{default:r(()=>s[15]||(s[15]=[e("i",{class:"fas fa-user-tie w-6 text-white"},null,-1),e("span",{class:"flex-1"},"Formateurs",-1)])),_:1},8,["href","class"]),n(i,{href:a(o)("formations.index"),class:f(["nav-link",{active:t("formations.index")}])},{default:r(()=>s[16]||(s[16]=[e("i",{class:"fas fa-book w-6 text-white"},null,-1),e("span",{class:"flex-1"},"Formations",-1)])),_:1},8,["href","class"]),n(i,{href:a(o)("disciplines.index"),class:f(["nav-link",{active:t("disciplines.index")}])},{default:r(()=>s[17]||(s[17]=[e("i",{class:"fas fa-book-open w-6 text-white"},null,-1),e("span",{class:"flex-1"},"Disciplines",-1)])),_:1},8,["href","class"])])):m("",!0),a(D)?(u(),d("div",es,[s[18]||(s[18]=e("h3",{class:"text-sm font-semibold text-gray-300 mb-3 flex items-center gap-2"},[e("i",{class:"fas fa-bell text-indigo-400"}),C(" Notifications ")],-1)),c.value.length?(u(),d("div",as,[(u(!0),d(q,null,G(c.value,p=>(u(),d("div",{key:p.id,class:"p-3 bg-gray-700 rounded-lg shadow-md hover:bg-gray-600 transition-all duration-200"},[e("p",ts,k(p.message),1),e("p",ls,k(p.created_at),1),e("button",{onClick:v=>P(p.id),class:"text-indigo-400 hover:text-indigo-300 text-xs mt-2 transition-colors"}," Marquer comme lu ",8,ns)]))),128))])):(u(),d("p",rs,"Aucune notification"))])):m("",!0),e("div",os,[_.value?(u(),d("button",{key:0,onClick:j,class:"nav-link w-full text-left bg-indigo-600 hover:bg-indigo-700"},s[19]||(s[19]=[e("i",{class:"fas fa-download w-6 text-white"},null,-1),e("span",{class:"flex-1"},"Installer l’app",-1)]))):(u(),d("button",{key:1,onClick:L,class:"nav-link w-full text-left bg-gray-600 hover:bg-gray-700"},s[20]||(s[20]=[e("i",{class:"fas fa-plus w-6 text-white"},null,-1),e("span",{class:"flex-1"},"Ajouter manuellement",-1)])))])]),e("div",is,[n(a(z),null,{default:r(()=>[n(a(R),{"as-child":""},{default:r(()=>[e("button",fs,[e("span",ds,[s[21]||(s[21]=e("i",{class:"fas fa-user w-6 text-indigo-400"},null,-1)),s[22]||(s[22]=e("span",{class:"flex-1"},"Profil",-1)),c.value.length?(u(),d("span",us,k(c.value.length),1)):m("",!0)]),s[23]||(s[23]=e("i",{class:"fas fa-chevron-down"},null,-1))])]),_:1}),n(a(W),{class:"bg-gray-800 text-gray-100 rounded-lg shadow-lg w-48"},{default:r(()=>[n(i,{class:"block px-4 py-2 hover:bg-gray-700 transition-all",href:a(o)("profile.edit"),as:"button"},{default:r(()=>s[24]||(s[24]=[C(" Paramètres ")])),_:1},8,["href"]),n(i,{class:"block px-4 py-2 hover:bg-gray-700 transition-all",method:"post",href:a(o)("logout"),as:"button"},{default:r(()=>s[25]||(s[25]=[C(" Déconnexion ")])),_:1},8,["href"])]),_:1})]),_:1})])])],2),e("main",cs,[h.value?m("",!0):(u(),d("button",{key:0,onClick:A,class:"lg:hidden fixed top-4 left-4 z-30 bg-indigo-600 text-white p-2 rounded-full shadow-lg hover:bg-indigo-700 transition-all"},s[26]||(s[26]=[e("i",{class:"fas fa-bars text-lg"},null,-1)]))),K(l.$slots,"default",{},void 0,!0),s[27]||(s[27]=e("div",{class:"scroll-hint bg-indigo-500 text-white px-3 py-1 rounded-full text-xs"},"Défiler",-1))])]))}}),bs=X(ps,[["__scopeId","data-v-f317ae05"]]);export{bs as M};
