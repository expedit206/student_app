import{a as L,b as z,_ as E}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BM4yh3Sc.js";import{d as R,r as w,n as T,l as V,k as B,e as d,o as u,a as e,p as m,u as a,g as l,w as n,z as f,T as o,t as y,b as C,F as I,f as q,y as G,R as K}from"./app-B1KS7jc-.js";import{_ as i}from"./TextLink.vue_vue_type_script_setup_true_lang-G4rz7gSn.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";const X={class:"min-h-screen bg-gray-900 text-gray-100 flex overflow-hidden"},H={class:"flex flex-col h-full"},J={class:"flex-1 py-4"},Q={key:0,class:"space-y-2"},U={key:0,class:"bg-red-500 text-white text-xs rounded-full px-2 py-0.5 ml-2 animate-pulse"},W={key:1,class:"space-y-2"},Y={key:2,class:"space-y-2"},Z={key:3,class:"mt-6 px-4"},ss={key:0,class:"space-y-3 max-h-64 overflow-y-auto"},es={class:"text-sm text-white"},as={class:"text-xs text-gray-400 mt-1"},ts=["onClick"],ls={key:1,class:"text-sm text-gray-400 italic"},ns={class:"mt-4 px-4"},os={class:"p-4 mt-auto"},rs={class:"flex items-center justify-between w-full px-4 py-3 bg-gray-800 text-gray-200 rounded-lg hover:bg-gray-700 transition-all duration-300"},is={class:"flex items-center gap-2"},fs={key:0,class:"bg-red-500 text-white text-xs rounded-full px-2 py-0.5 animate-pulse"},ds={class:"flex-1 p-4 sm:p-6 bg-gray-800 overflow-y-auto transition-all duration-300 relative animate-fade-in"},us=R({__name:"MonLayout",setup(ps){var M;const h=w(!1),A=()=>{h.value=!h.value},k=T(),x=k.props.auth.user,N=x&&x.role==="admin",S=x&&x.role==="formateur",D=x&&x.role==="apprenant",p=w(((M=k.props.dashboardData)==null?void 0:M.notifications)||[]);V(()=>{var r;return(r=k.props.dashboardData)==null?void 0:r.notifications},r=>{p.value=r||[]},{immediate:!0});const F=B(()=>p.value.filter(r=>r.type==="note_update").length),P=r=>{var c;const s=(c=document.querySelector('meta[name="csrf-token"]'))==null?void 0:c.content;if(!s){console.error("CSRF token not found");return}K.post(o("notifications.read",r),{},{headers:{"X-CSRF-TOKEN":s}}).then(v=>{v.data.success&&(p.value=p.value.filter(b=>b.id!==r))}).catch(v=>{var b;console.error("Error:",((b=v.response)==null?void 0:b.data)||v.message)})},t=r=>o().current(r),g=w(null),_=w(!1);window.addEventListener("beforeinstallprompt",r=>{r.preventDefault(),g.value=r,_.value=!0});const $=async()=>{if(g.value){g.value.prompt();const{outcome:r}=await g.value.userChoice;console.log(r==="accepted"?"Application installée":"Installation refusée"),g.value=null,_.value=!1}},j=()=>{alert('Ajoutez cette page à votre écran d’accueil via le menu du navigateur (ex. "Ajouter à l’écran d’accueil" sur Chrome).')};return(r,s)=>(u(),d("div",X,[e("aside",{class:f(["sidebar flex-shrink-0 bg-gradient-to-b from-gray-800 to-gray-900 shadow-xl transition-all duration-300",h.value?"w-64":"w-0 lg:w-64"])},[e("div",H,[e("div",{class:"p-4 flex items-center justify-between bg-gray-900"},[s[1]||(s[1]=e("div",{class:"flex items-center gap-3"},[e("div",{class:"bg-white p-1 rounded-full shadow-md"},[e("img",{src:"/img/logo.png",alt:"Logo CFPCa",class:"h-10 w-10 rounded-full animate-spin-slow"})]),e("span",{class:"text-lg font-bold text-white"},"CFPCa")],-1)),e("button",{onClick:A,class:"lg:hidden text-gray-200 hover:text-white p-2 rounded-full hover:bg-gray-600 transition-all"},s[0]||(s[0]=[e("i",{class:"fas fa-times text-lg"},null,-1)]))]),e("nav",J,[a(D)?(u(),d("div",Q,[l(i,{href:a(o)("apprenant.dashboard"),class:f(["nav-link",{active:t("apprenant.dashboard")}])},{default:n(()=>s[2]||(s[2]=[e("i",{class:"fas fa-tachometer-alt w-6 text-indigo-400"},null,-1),e("span",{class:"flex-1"},"Dashboard",-1)])),_:1},8,["href","class"]),l(i,{href:a(o)("apprenant.disciplines"),class:f(["nav-link",{active:t("apprenant.disciplines")}])},{default:n(()=>s[3]||(s[3]=[e("i",{class:"fas fa-book-open w-6 text-indigo-400"},null,-1),e("span",{class:"flex-1"},"Mes Disciplines",-1)])),_:1},8,["href","class"]),l(i,{href:a(o)("apprenant.notes"),class:f(["nav-link",{active:t("apprenant.notes")}])},{default:n(()=>[s[4]||(s[4]=e("i",{class:"fas fa-star w-6 text-indigo-400"},null,-1)),s[5]||(s[5]=e("span",{class:"flex-1"},"Mes Notes",-1)),F.value>0?(u(),d("span",U,y(F.value),1)):m("",!0)]),_:1},8,["href","class"]),l(i,{href:a(o)("apprenant.carnet"),class:f(["nav-link",{active:t("apprenant.carnet")}])},{default:n(()=>s[6]||(s[6]=[e("i",{class:"fas fa-book w-6 text-indigo-400"},null,-1),e("span",{class:"flex-1"},"Mon Carnet",-1)])),_:1},8,["href","class"]),l(i,{href:a(o)("apprenant.progression"),class:f(["nav-link",{active:t("apprenant.progression")}])},{default:n(()=>s[7]||(s[7]=[e("i",{class:"fas fa-chart-line w-6 text-indigo-400"},null,-1),e("span",{class:"flex-1"},"Ma Progression",-1)])),_:1},8,["href","class"])])):m("",!0),a(S)?(u(),d("div",W,[l(i,{href:a(o)("formateur.dashboard"),class:f(["nav-link",{active:t("formateur.dashboard"),"formateur-active":t("formateur.dashboard")}])},{default:n(()=>s[8]||(s[8]=[e("i",{class:"fas fa-tachometer-alt w-6 text-red-400"},null,-1),e("span",{class:"flex-1"},"Dashboard",-1)])),_:1},8,["href","class"]),l(i,{href:a(o)("formateur.formations"),class:f(["nav-link",{active:t("formateur.formations"),"formateur-active":t("formateur.formations")}])},{default:n(()=>s[9]||(s[9]=[e("i",{class:"fas fa-book w-6 text-red-400"},null,-1),e("span",{class:"flex-1"},"Mes Formations",-1)])),_:1},8,["href","class"]),l(i,{href:a(o)("formateur.apprenants"),class:f(["nav-link",{active:t("formateur.apprenants"),"formateur-active":t("formateur.apprenants")}])},{default:n(()=>s[10]||(s[10]=[e("i",{class:"fas fa-users w-6 text-red-400"},null,-1),e("span",{class:"flex-1"},"Mes Apprenants",-1)])),_:1},8,["href","class"]),l(i,{href:a(o)("formateur.notes"),class:f(["nav-link",{active:t("formateur.notes"),"formateur-active":t("formateur.notes")}])},{default:n(()=>s[11]||(s[11]=[e("i",{class:"fas fa-star w-6 text-red-400"},null,-1),e("span",{class:"flex-1"},"Gérer les Notes",-1)])),_:1},8,["href","class"]),l(i,{href:a(o)("formateur.disciplines"),class:f(["nav-link",{active:t("formateur.disciplines"),"formateur-active":t("formateur.disciplines")}])},{default:n(()=>s[12]||(s[12]=[e("i",{class:"fas fa-book-open w-6 text-red-400"},null,-1),e("span",{class:"flex-1"},"Mes Disciplines",-1)])),_:1},8,["href","class"])])):m("",!0),a(N)?(u(),d("div",Y,[l(i,{href:a(o)("admin.dashboard"),class:f(["nav-link",{active:t("admin.dashboard")}])},{default:n(()=>s[13]||(s[13]=[e("i",{class:"fas fa-tachometer-alt w-6 text-white"},null,-1),e("span",{class:"flex-1"},"Dashboard Admin",-1)])),_:1},8,["href","class"]),l(i,{href:a(o)("apprenants.index"),class:f(["nav-link",{active:t("apprenants.index")}])},{default:n(()=>s[14]||(s[14]=[e("i",{class:"fas fa-user-tie w-6 text-white"},null,-1),e("span",{class:"flex-1"},"Apprenants",-1)])),_:1},8,["href","class"]),l(i,{href:a(o)("formateurs.index"),class:f(["nav-link",{active:t("formateurs.index")}])},{default:n(()=>s[15]||(s[15]=[e("i",{class:"fas fa-user-tie w-6 text-white"},null,-1),e("span",{class:"flex-1"},"Formateurs",-1)])),_:1},8,["href","class"]),l(i,{href:a(o)("formations.index"),class:f(["nav-link",{active:t("formations.index")}])},{default:n(()=>s[16]||(s[16]=[e("i",{class:"fas fa-book w-6 text-white"},null,-1),e("span",{class:"flex-1"},"Formations",-1)])),_:1},8,["href","class"]),l(i,{href:a(o)("disciplines.index"),class:f(["nav-link",{active:t("disciplines.index")}])},{default:n(()=>s[17]||(s[17]=[e("i",{class:"fas fa-book-open w-6 text-white"},null,-1),e("span",{class:"flex-1"},"Disciplines",-1)])),_:1},8,["href","class"])])):m("",!0),a(D)?(u(),d("div",Z,[s[18]||(s[18]=e("h3",{class:"text-sm font-semibold text-gray-300 mb-3 flex items-center gap-2"},[e("i",{class:"fas fa-bell text-indigo-400"}),C(" Notifications ")],-1)),p.value.length?(u(),d("div",ss,[(u(!0),d(I,null,q(p.value,c=>(u(),d("div",{key:c.id,class:"p-3 bg-gray-700 rounded-lg shadow-md hover:bg-gray-600 transition-all duration-200"},[e("p",es,y(c.message),1),e("p",as,y(c.created_at),1),e("button",{onClick:v=>P(c.id),class:"text-indigo-400 hover:text-indigo-300 text-xs mt-2 transition-colors"}," Marquer comme lu ",8,ts)]))),128))])):(u(),d("p",ls,"Aucune notification"))])):m("",!0),e("div",ns,[_.value?(u(),d("button",{key:0,onClick:$,class:"nav-link w-full text-left bg-indigo-600 hover:bg-indigo-700"},s[19]||(s[19]=[e("i",{class:"fas fa-download w-6 text-white"},null,-1),e("span",{class:"flex-1"},"Installer l’app",-1)]))):(u(),d("button",{key:1,onClick:j,class:"nav-link w-full text-left bg-gray-600 hover:bg-gray-700"},s[20]||(s[20]=[e("i",{class:"fas fa-plus w-6 text-white"},null,-1),e("span",{class:"flex-1"},"Ajouter manuellement",-1)])))])]),e("div",os,[l(a(E),null,{default:n(()=>[l(a(L),{"as-child":""},{default:n(()=>[e("button",rs,[e("span",is,[s[21]||(s[21]=e("i",{class:"fas fa-user w-6 text-indigo-400"},null,-1)),s[22]||(s[22]=e("span",{class:"flex-1"},"Profil",-1)),p.value.length?(u(),d("span",fs,y(p.value.length),1)):m("",!0)]),s[23]||(s[23]=e("i",{class:"fas fa-chevron-down"},null,-1))])]),_:1}),l(a(z),{class:"bg-gray-800 text-gray-100 rounded-lg shadow-lg w-48"},{default:n(()=>[l(i,{class:"block px-4 py-2 hover:bg-gray-700 transition-all",href:a(o)("profile.edit"),as:"button"},{default:n(()=>s[24]||(s[24]=[C(" Paramètres ")])),_:1},8,["href"]),l(i,{class:"block px-4 py-2 hover:bg-gray-700 transition-all",method:"post",href:a(o)("logout"),as:"button"},{default:n(()=>s[25]||(s[25]=[C(" Déconnexion ")])),_:1},8,["href"])]),_:1})]),_:1})])])],2),e("main",ds,[h.value?m("",!0):(u(),d("button",{key:0,onClick:A,class:"lg:hidden fixed top-4 left-4 z-30 bg-indigo-600 text-white p-2 rounded-full shadow-lg hover:bg-indigo-700 transition-all"},s[26]||(s[26]=[e("i",{class:"fas fa-bars text-lg"},null,-1)]))),G(r.$slots,"default",{},void 0,!0),s[27]||(s[27]=e("div",{class:"scroll-hint bg-indigo-500 text-white px-3 py-1 rounded-full text-xs"},"Défiler",-1))])]))}}),vs=O(us,[["__scopeId","data-v-5a7c1ad4"]]);export{vs as M};
